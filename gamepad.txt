// Script de Suporte a Gamepad para Siri Cascudo Pro
(function() {
    console.log("游꿡 Sistema de Gamepad Iniciado...");

    function updateGamepad() {
        const gamepads = navigator.getGamepads();
        const gp = gamepads[0]; // Pega o primeiro controle conectado

        if (gp) {
            // Anal칩gico Esquerdo: Movimenta칞칚o (Eixos 0 e 1)
            const deadzone = 0.1;
            let stickX = Math.abs(gp.axes[0]) > deadzone ? gp.axes[0] : 0;
            let stickZ = Math.abs(gp.axes[1]) > deadzone ? gp.axes[1] : 0;

            // Simula o pressionamento de teclas para o motor original entender
            keys['KeyD'] = stickX > 0.3;
            keys['KeyA'] = stickX < -0.3;
            keys['KeyS'] = stickZ > 0.3;
            keys['KeyW'] = stickZ < -0.3;

            // Anal칩gico Direito: Rota칞칚o de C칙mera (Eixo 2)
            if (Math.abs(gp.axes[2]) > deadzone) {
                camRot -= gp.axes[2] * 0.04;
            }

            // Bot칚o "A" (Xbox) ou "X" (PS): Pulo (Bot칚o 0)
            if (gp.buttons[0].pressed) {
                jump();
            }

            // Bot칚o "B" (Xbox) ou "O" (PS): Ativar/Desativar Voo (Bot칚o 1)
            // Usamos um pequeno atraso para n칚o alternar r치pido demais
            if (gp.buttons[1].pressed && !window.gpBtnPressed) {
                toggleFly();
                window.gpBtnPressed = true;
                setTimeout(() => window.gpBtnPressed = false, 300);
            }
        }
        requestAnimationFrame(updateGamepad);
    }

    // Inicia o monitoramento
    updateGamepad();
    alert("Controle Ativado! Use os anal칩gicos e o bot칚o de pulo.");
})();
